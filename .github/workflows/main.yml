name: Build and Publish Pipeline

on:
    push: 
        # TODO: uncomment the following line on forks 
        # branches: main
 
        # TODO: remove the following line on forks
        tags: "v*"

jobs:
    generate-resume:
        name: Generate Resume
        uses: ./.github/workflows/resume.yml

    publish-site:
        name: Publish Site
        needs: generate-resume
        uses: ./.github/workflows/website.yml

    # TODO: remove the following two workflow calls on forks

    publish-package:
        name: Publish to PyPI
        if: github.repository == 'cybardev/resumake'
        uses: ./.github/workflows/pypi.yml

    publish-docker:
        name: Publish Docker image
        needs: publish-package
        uses: ./.github/workflows/docker.yml